
<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Parametric Box-Wing Inversion &#8212; MIRAGE  documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'gallery/01-light_curve_inversion/parametric_box_wing';</script>
    <link rel="icon" href="../../_static/sid_logo_dark.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Multiple Hypothesis Inversion" href="multi_hypothesis_inversion.html" />
    <link rel="prev" title="Face Uncertainty" href="face_uncertainty.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/sid_logo_light.png" class="logo__image only-light" alt=""/>
    <script>document.write(`<img src="../../_static/sid_logo_dark.png" class="logo__image only-dark" alt=""/>`);</script>
  
  
    <p class="title logo__title">MIRAGE</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../getting_started.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../modules.html">
                        mirage
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        Examples Gallery
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../references.html">
                        References
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../getting_started.html">
                        Getting Started
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../modules.html">
                        mirage
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        Examples Gallery
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../references.html">
                        References
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../00-orbits/index.html">Orbits</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../00-orbits/universal_variables.html">Universal Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../00-orbits/propagate_single_tle.html">Propagating single TLE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../00-orbits/hifi_propagation.html">Propagating with Perturbations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../00-orbits/tle_switching.html">TLE Switching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../00-orbits/ground_track.html">Ground Tracks</a></li>

<li class="toctree-l2"><a class="reference internal" href="../00-orbits/propagate_catalog.html">Propagating the catalog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../00-orbits/precise_orbit_determination.html">Precise Orbit Determination with Batch Least Squares</a></li>
<li class="toctree-l2"><a class="reference internal" href="../00-orbits/restricted_circular_od.html">Restricted Circular IOD</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../000-work-in-progress/index.html">Works In Progress</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../000-work-in-progress/iod_testing.html">Classical IOD Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../000-work-in-progress/inversion_gradient.html">EGI Jacobian</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Light Curve Inversion</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="kass_durech_vs_python.html">Support Optimization Comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="perfect_info_inversion.html">Perfect Information Inversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="poisson_shape_variance.html">Shape Uncertainty</a></li>
<li class="toctree-l2"><a class="reference internal" href="noisy_inversion_pdf.html">Inversion PDF</a></li>
<li class="toctree-l2"><a class="reference internal" href="face_uncertainty.html">Face Uncertainty</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Parametric Box-Wing Inversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="multi_hypothesis_inversion.html">Multiple Hypothesis Inversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="aas_non_convex_inversion.html">Non-Convex Inversion</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../01-light_curves/index.html">Light Curves</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../01-light_curves/convex_light_curve.html">Convex Light Curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01-light_curves/rotate_panels_vid.html">Rotating Solar Panels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01-light_curves/support_unobservability.html">Support Unobservability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01-light_curves/noisy_light_curve.html">Noisy Light Curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01-light_curves/engine_vs_convex.html">Convex vs Engine Light Curves</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01-light_curves/light_curve_ambiguities.html">Light Curve Ambiguities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01-light_curves/neural_network_brightness.html">Neural Network Brightness</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01-light_curves/brdf_renders.html">BRDFs in Action</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01-light_curves/light_curve_units.html">Light Curve Units</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01-light_curves/lc_uncertainty.html">Light Curve Uncertainty</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01-light_curves/light_curves_types.html">Types of Light Curves</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../03-coordinate-systems/index.html">Coordinate Frames</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../03-coordinate-systems/time_systems.html">Time Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03-coordinate-systems/equation_of_time.html">The Equation of Time</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03-coordinate-systems/polar_motion.html">Polar Motion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03-coordinate-systems/third_body_interp.html">Third Body Interpolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03-coordinate-systems/precession_and_nutation.html">Precession and Nutation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03-coordinate-systems/coord_interp.html">Coordinate System Interpolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03-coordinate-systems/spice_comparison.html">SPICE vs Vallado</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03-coordinate-systems/equinoxes.html">Equinoxes and Solstices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03-coordinate-systems/itrf_to_j2000.html">IAU-76 J2000 Reduction</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../04-environment/index.html">Environment</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../04-environment/luminous_efficiency.html">Luminous Efficiency Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04-environment/twilight_model.html">Twilight Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04-environment/vr_factor.html">Airmass Function Comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04-environment/star_aberration.html">Star Aberration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04-environment/space_weather.html">Space Weather</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04-environment/astro_spectra.html">Astrometrical Spectra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04-environment/background_zenith.html">Background Signals at Zenith</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04-environment/atmospheric_absorption.html">Atmospheric Transmission</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04-environment/penumbra_plane.html">Penumbra Visualized</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04-environment/geoid_heights.html">Global Elevation</a></li>

<li class="toctree-l2"><a class="reference internal" href="../04-environment/vesuvius_terrain.html">Terrain Tiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04-environment/total_solar_irradiance.html">Total Solar Irradiance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04-environment/passbands.html">Passbands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04-environment/solar_system.html">Solar System</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04-environment/nightlights.html">Zenith Light Pollution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04-environment/star_catalogs.html">Star Catalogs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04-environment/gaia_patched_catalog.html">GAIA Patched Catalog</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04-environment/background_signals.html">Background Signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04-environment/reflected_albedo.html">Earth Albedo BRDF</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../05-vis/index.html">Plotting Options</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../05-vis/moon_libration.html">Moon Librations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../05-vis/plot_earth.html">Plotting Earth</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../06-attitude/index.html">Rigid Body Attitudes</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../06-attitude/euler_sequence.html">Euler Angle Sequence</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06-attitude/vis_attitude_motion.html">Rigid Body Torque Free Attitudes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06-attitude/aligned_angle_constrained.html">Aligned and Constrained</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06-attitude/light_curve_iso_surfaces.html">Brightness Isosurfaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="../06-attitude/torque_free_axisymmetric.html">Torque-free Attitude Propagation</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../07-observer/index.html">Observer</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../07-observer/light_time_delay.html">Light Time Delay</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07-observer/local_sidereal_time.html">Local Sidereal Time</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07-observer/conic_sensor.html">Conic Sensors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07-observer/synthetic_rpo_images.html">Synthetic RPO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07-observer/atmos_refraction.html">Atmospheric Refraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07-observer/az_el_parallel.html">Azimuth/Elevation Conversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07-observer/horizon_mask.html">Horizon Masks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07-observer/pogs_local_terrain.html">POGS Local Terrain</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07-observer/visualize_constraints.html">Horizon Masked Observations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07-observer/local_hemisphere.html">Live Satellites From Observer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../07-observer/fit_background.html">Fitting the Background</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../08-utility/index.html">Utility</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../08-utility/wavelength_to_rgb.html">Wavelength to RGB</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08-utility/fitting_poisson_process.html">Fitting Poisson Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08-utility/count_lines.html">Counting Source Code Lines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08-utility/samplers.html">Samplers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08-utility/spherical_voronoi_interp.html">Spherical Voronoi Interpolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08-utility/random_figures_for_defense_pres.html">Figures for MS Defense</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08-utility/computer_graphics_background.html">Graphics Background</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08-utility/egi_optimization.html">EGI Optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../08-utility/model_editor.html">Model Editor</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../09-models/index.html">3D Models</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../09-models/introduce_concavity.html">Introducing Concavities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../09-models/merge_bracket.html">Shape Interpolation Bracket</a></li>
<li class="toctree-l2"><a class="reference internal" href="../09-models/merge_biased.html">Merging with Bias</a></li>
<li class="toctree-l2"><a class="reference internal" href="../09-models/shape_interpolation.html">Shape Interpolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../09-models/satellite_lineup.html">Satellite Lineup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../09-models/sfds.html">Signed Distance Fields</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../10-ccd/index.html">CCD Characterization</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../10-ccd/mapping_function.html">Mapping Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="../10-ccd/characterize_ccd.html">Characterizing the CCD Background</a></li>
<li class="toctree-l2"><a class="reference internal" href="../10-ccd/ccd_integration_time.html">Integration Time</a></li>
<li class="toctree-l2"><a class="reference internal" href="../10-ccd/noise_accum_gifs.html">Noise Sampling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../10-ccd/airy_disk_gaussian_fit.html">Airy Disk Gaussian Fit</a></li>
<li class="toctree-l2"><a class="reference internal" href="../10-ccd/ccd_heuristics.html">CCD Heuristics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../10-ccd/airy_disk_diffraction.html">Airy Disk Diffraction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../10-ccd/precise_star_matching.html">Precise Star Matching</a></li>
<li class="toctree-l2"><a class="reference internal" href="../10-ccd/background_shape.html">Background Shape</a></li>
<li class="toctree-l2"><a class="reference internal" href="../10-ccd/streaks.html">Streak Detection and Centroiding</a></li>
<li class="toctree-l2"><a class="reference internal" href="../10-ccd/snr.html">Signal-to-Noise Ratio (SNR)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../10-ccd/render_ccd.html">CCD Rendering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../10-ccd/star_matching.html">Star Matching</a></li>
</ul>
</li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Examples Gallery</a></li>
    
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Light Curve Inversion</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">Parametric...</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-gallery-01-light-curve-inversion-parametric-box-wing-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="parametric-box-wing-inversion">
<span id="sphx-glr-gallery-01-light-curve-inversion-parametric-box-wing-py"></span><h1>Parametric Box-Wing Inversion<a class="headerlink" href="#parametric-box-wing-inversion" title="Permalink to this heading">#</a></h1>
<img src="../../_images/sphx_glr_parametric_box_wing_001.png" srcset="../../_images/sphx_glr_parametric_box_wing_001.png, ../../_images/sphx_glr_parametric_box_wing_001_2_00x.png 2.00x" alt="parametric box wing" class = "sphx-glr-single-img"/><div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>367973.89241886756
367973.8924187666
367973.8924187654
367973.8924188664
367973.8924188173
367973.8924188725
367973.89241887874
367973.89241885947
367973.8924188627
367956.9939446367
367956.99394439295
367956.9939443936
367956.9939446343
367956.99394458585
367956.99394464545
367956.9939447062
367956.99394458614
367956.9939446282
367737.21912434715
367737.2191234384
367737.2191234475
367737.2191243447
367737.2191242932
367737.2191243749
367737.2191253201
367737.2191235535
367737.2191243197
363811.74351965263
363811.743515436
363811.7435154848
363811.74351965263
363811.74351958564
363811.74351965263
363811.74351965263
363811.7435087519
363811.74351951573
287698.0313644586
287698.0313477454
287698.0313479436
287698.0313644586
287698.03136438405
287698.0313644586
287698.0313644586
287698.03129597596
287698.0313640709
1842141.083886653
1842141.084023001
1842141.084021372
1842141.083886653
1842141.0838868616
1842141.083886653
1842141.083886653
1842141.0833968464
1842141.0838876215
254318.24577617864
254318.2457636133
254318.24576376262
254318.24577617864
254318.24577612596
254318.24577617864
254318.24577617864
254318.24571479452
254318.24577581958
240451.68207847964
240451.68208229908
240451.68208225362
240451.68207847964
240451.6820784762
240451.68207847964
240451.68207847964
240451.68205275692
240451.68207829088
240192.87127238887
240192.87127275363
240192.87127274924
240192.87127238887
240192.871272376
240192.87127238887
240192.87127238887
240192.87123940853
240192.8712721628
240155.10766731642
240155.10766857016
240155.10766855523
240155.10766731642
240155.107667306
240155.10766731642
240155.10766731642
240155.10763622093
240155.10766709986
367481.8617323056
367481.8617323056
367481.8617323056
367481.8617323056
367481.86173230474
367481.8617323056
367481.8617323056
367481.8617323056
367481.86173237965
328931.8036577949
328931.8036577717
328931.80365777196
328931.8036577949
328931.8036574383
328931.8036577949
328931.8036577949
328931.80366115796
328931.8036606836
2723448.6811620966
2723448.68131443
2723448.6813126095
2723448.6811620966
2723448.681162324
2723448.6811620966
2723448.6811620966
2723448.680098558
2723448.6811631205
240154.58478375647
240154.58478512548
240154.58478510918
240154.58478375647
240154.5847837463
240154.58478375647
240154.58478375647
240154.58475291048
240154.58478354124
240153.52865102084
240153.5286523897
240153.5286523734
240153.52865102084
240153.52865101074
240153.52865102084
240153.52865102084
240153.52862017986
240153.52865080553
240149.30581741512
240149.30581878294
240149.30581876665
240149.30581741512
240149.30581740502
240149.30581741512
240149.30581741512
240149.3057865941
240149.30581719967
240132.44162310025
240132.44162446444
240132.44162444814
240132.44162310025
240132.44162308998
240132.44162310025
240132.44162310025
240132.44159235916
240132.44162288445
240065.4179878626
240065.4179892122
240065.41798919594
240065.4179878626
240065.4179878522
240065.4179878626
240065.4179878626
240065.41795743952
240065.41798764557
239804.18483101288
239804.1848323008
239804.18483228472
239804.18483101288
239804.18483100188
239804.18483101288
239804.18483101288
239804.18480183595
239804.18483079065
238864.98673382206
238864.98673481544
238864.98673480115
238864.98673382206
238864.98673380836
238864.98673382206
238864.98673382206
238864.9867092453
238864.98673357794
236727.02741351564
236727.02741354154
236727.02741354087
236727.02741351564
236727.0274134082
236727.02741351564
236727.02741351564
236727.02739965756
236727.02741313312
234381.01849579587
234381.01849349833
234381.01849360424
234381.01849579587
234381.0184954671
234381.01849579587
234381.01849579587
234381.01849688077
234381.0184957487
233596.43792256078
233596.43792170504
233596.43792169116
233596.43792256078
233596.4379222388
233596.43792256078
233596.43792256078
233596.4379263879
233596.4379225779
232372.78972374668
232372.78972484122
232372.78972485213
232372.78972374668
232372.78972344415
232372.78972374668
232372.78972374668
232372.7897302913
232372.78972388696
230297.2504163532
230297.2504189902
230297.25041933788
230297.2504163532
230297.25041607278
230297.2504163532
230297.2504163532
230297.250424989
230297.2504167034
226004.8972026752
226004.8972019037
226004.89720119105
226004.8972026752
226004.89720238425
226004.8972026752
226004.8972026752
226004.89721636422
226004.89720344823
235600.48664372222
235600.48663724476
235600.48660804998
235600.48664372222
235600.48664334865
235600.48664372222
235600.48664372222
235600.48666805477
235600.48664566502
224108.4134055305
224108.4134025674
224108.4133979816
224108.4134055305
224108.41340521822
224108.4134055305
224108.4134055305
224108.41342293305
224108.41340658607
220327.81316352042
220327.81316057208
220327.8131552323
220327.81316352042
220327.8131632021
220327.81316352042
220327.81316352042
220327.81318282586
220327.8131648306
206557.1553341946
206557.1553305021
206557.1553184856
206557.1553341946
206557.15533384195
206557.1553341946
206557.1553341946
206557.15535977224
206557.15533627535
181434.782237928
181434.7822350408
181434.78221210247
181434.782237928
181434.78223755522
181434.782237928
181434.782237928
181434.7822620093
181434.782232108
129893.07883358464
129893.0788323491
129893.07881168509
129893.07883358464
129893.07883324851
129893.07883358464
129893.07883358464
129893.07884706251
129893.07882570397
268259.5424814201
268259.5424814201
268259.5424814201
268259.5424814201
268259.54248186084
268259.5424814201
268259.5424814201
268259.5424814201
268259.542466839
90260.84531310195
90260.84531288575
90260.8453016236
90260.84531310195
90260.84531296493
90260.84531310195
90260.84531310195
90260.84531598311
90260.84530453023
101135.36983944914
101135.36983944914
101135.36983944914
101135.36983944914
101135.36983958833
101135.36983944914
101135.36983944914
101135.36983944914
101135.36983282836
81536.78337377097
81536.78337371837
81536.78336313719
81536.78337377097
81536.78337381138
81536.78337377097
81536.78337377097
81536.78337442626
81536.78337124501
80421.37097691368
80421.37097590999
80421.37095956279
80421.37097691368
80421.37097671011
80421.37097691368
80421.37097691368
80421.37098873907
80421.37098667661
76555.4520416297
76555.45204114344
76555.45202604184
76555.4520416297
76555.4520415327
76555.4520416297
76555.4520416297
76555.4520474876
76555.45204544313
71122.47505955602
71122.47505926492
71122.47505604765
71122.47505955602
71122.47505947642
71122.47505955602
71122.47505955602
71122.47506429302
71122.47506015962
69862.19324353235
69862.19324337447
69862.19324174816
69862.19324353235
69862.19324349253
69862.19324353235
69862.19324353235
69862.19324671618
69862.1932430186
68799.34039771142
68799.34039759738
68799.34039662813
68799.34039771142
68799.34039768878
68799.34039771142
68799.34039771142
68799.34040035079
68799.34039802254
68631.05866934905
68631.05866929912
68631.05866890519
68631.05866934905
68631.05866933853
68631.05866934905
68631.05866934905
68631.05867126021
68631.05866941148
68590.29375236291
68590.29375235667
68590.2937523096
68590.29375236291
68590.29375235616
68590.29375236291
68590.29375236291
68590.2937538205
68590.29375240226
bwp_opt.wing_area=12159.3943486734 bwp_opt.scales=(255.55877505239633, 29.95111235450622, 37.6573192562958) bwp_opt.brdf_box.cd=0.0 bwp_opt.brdf_wing.cd=0.0 bwp_opt.brdf_box.n=66.72865525284259 bwp_opt.brdf_wing.n=123.39099741152117 bwp_opt.brdf_box.cs=1.0 bwp_opt.brdf_wing.cs=1.0
</pre></div>
</div>
<div class="line-block">
<div class="line"><br /></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">minimize</span>

<span class="kn">import</span> <span class="nn">mirage</span> <span class="k">as</span> <span class="nn">mr</span>


<span class="k">def</span> <span class="nf">construct_from_y</span><span class="p">(</span><span class="n">attitude</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
    <span class="n">cd_wing</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">cd_box</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="mf">1e-8</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">inf</span><span class="p">)</span>
    <span class="n">n_box</span><span class="p">,</span> <span class="n">n_wing</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
    <span class="n">brdf_box</span> <span class="o">=</span> <span class="n">mr</span><span class="o">.</span><span class="n">Brdf</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;phong&quot;</span><span class="p">,</span> <span class="n">cd</span><span class="o">=</span><span class="n">cd_box</span><span class="p">,</span> <span class="n">cs</span><span class="o">=</span><span class="mi">1</span> <span class="o">-</span> <span class="n">cd_box</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n_box</span><span class="p">)</span>
    <span class="n">brdf_wing</span> <span class="o">=</span> <span class="n">mr</span><span class="o">.</span><span class="n">Brdf</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;phong&quot;</span><span class="p">,</span> <span class="n">cd</span><span class="o">=</span><span class="n">cd_wing</span><span class="p">,</span> <span class="n">cs</span><span class="o">=</span><span class="mi">1</span> <span class="o">-</span> <span class="n">cd_wing</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n_wing</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">BoxWingParametric</span><span class="p">(</span>
        <span class="n">attitude</span><span class="p">,</span>
        <span class="n">brdf_box</span><span class="p">,</span>
        <span class="n">brdf_wing</span><span class="p">,</span>
        <span class="n">x_scale</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
        <span class="n">y_scale</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
        <span class="n">z_scale</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
        <span class="n">wing_area</span><span class="o">=</span><span class="n">y</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
    <span class="p">)</span>


<span class="k">class</span> <span class="nc">BoxWingParametric</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">attitude</span><span class="p">:</span> <span class="n">mr</span><span class="o">.</span><span class="n">AlignedAndConstrainedAttitude</span><span class="p">,</span>
        <span class="n">brdf_box</span><span class="p">:</span> <span class="n">mr</span><span class="o">.</span><span class="n">Brdf</span><span class="p">,</span>
        <span class="n">brdf_wing</span><span class="p">:</span> <span class="n">mr</span><span class="o">.</span><span class="n">Brdf</span><span class="p">,</span>
        <span class="n">x_scale</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">y_scale</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">z_scale</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">wing_area</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attitude</span> <span class="o">=</span> <span class="n">attitude</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">brdf_box</span> <span class="o">=</span> <span class="n">brdf_box</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">brdf_wing</span> <span class="o">=</span> <span class="n">brdf_wing</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scales</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_scale</span><span class="p">,</span> <span class="n">y_scale</span><span class="p">,</span> <span class="n">z_scale</span><span class="p">)</span>
        <span class="n">cube_template</span> <span class="o">=</span> <span class="n">mr</span><span class="o">.</span><span class="n">SpaceObject</span><span class="p">(</span><span class="s2">&quot;cube.obj&quot;</span><span class="p">)</span>
        <span class="n">cube_template</span><span class="o">.</span><span class="n">v</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">*=</span> <span class="n">x_scale</span>
        <span class="n">cube_template</span><span class="o">.</span><span class="n">v</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*=</span> <span class="n">y_scale</span>
        <span class="n">cube_template</span><span class="o">.</span><span class="n">v</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">*=</span> <span class="n">z_scale</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">box</span> <span class="o">=</span> <span class="n">mr</span><span class="o">.</span><span class="n">SpaceObject</span><span class="p">(</span><span class="n">vertices_and_faces</span><span class="o">=</span><span class="p">(</span><span class="n">cube_template</span><span class="o">.</span><span class="n">v</span><span class="p">,</span> <span class="n">cube_template</span><span class="o">.</span><span class="n">f</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wing_area</span> <span class="o">=</span> <span class="n">wing_area</span>

    <span class="k">def</span> <span class="nf">eval</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">dates</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">ovi</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="n">jd</span> <span class="o">=</span> <span class="n">mr</span><span class="o">.</span><span class="n">date_to_jd</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span>
        <span class="n">eci_to_body</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attitude</span><span class="o">.</span><span class="n">dcms_at_dates</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span>

        <span class="n">vc_eci</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">attitude</span><span class="o">.</span><span class="n">const_interpolator</span><span class="p">(</span><span class="n">jd</span><span class="p">)</span>

        <span class="n">ovb</span> <span class="o">=</span> <span class="n">mr</span><span class="o">.</span><span class="n">stack_mat_mult_vec</span><span class="p">(</span><span class="n">eci_to_body</span><span class="p">,</span> <span class="n">ovi</span><span class="p">)</span>
        <span class="n">vc_body</span> <span class="o">=</span> <span class="n">mr</span><span class="o">.</span><span class="n">stack_mat_mult_vec</span><span class="p">(</span><span class="n">eci_to_body</span><span class="p">,</span> <span class="n">vc_eci</span><span class="p">)</span>

        <span class="c1"># pl = pv.Plotter()</span>
        <span class="c1"># mrv.plot3(pl, vc_body)</span>
        <span class="c1"># mrv.plot3(pl, ovb)</span>
        <span class="c1"># pl.show()</span>
        <span class="c1"># eneddds</span>

        <span class="n">box_lc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">box</span><span class="o">.</span><span class="n">convex_light_curve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">brdf_box</span><span class="p">,</span> <span class="n">svb</span><span class="o">=</span><span class="n">vc_body</span><span class="p">,</span> <span class="n">ovb</span><span class="o">=</span><span class="n">ovb</span><span class="p">)</span>
        <span class="n">wing_lc</span> <span class="o">=</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wing_area</span>
            <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">brdf_wing</span><span class="o">.</span><span class="n">eval_normalized_brightness</span><span class="p">(</span>
                <span class="n">L</span><span class="o">=</span><span class="n">vc_body</span><span class="p">,</span> <span class="n">O</span><span class="o">=</span><span class="n">ovb</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="n">vc_body</span>
            <span class="p">)</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">box_lc</span><span class="p">,</span> <span class="n">wing_lc</span>

    <span class="k">def</span> <span class="nf">optimize</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">dates</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">[</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
        <span class="n">ovi</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
        <span class="n">lc_unit_observed</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span>
    <span class="p">):</span>
        <span class="n">valid_inds</span> <span class="o">=</span> <span class="o">~</span><span class="n">lc_unit_observed</span><span class="o">.</span><span class="n">mask</span>

        <span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">y</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
            <span class="n">bwpi</span> <span class="o">=</span> <span class="n">construct_from_y</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attitude</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
            <span class="n">box_lc</span><span class="p">,</span> <span class="n">wing_lc</span> <span class="o">=</span> <span class="n">bwpi</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span> <span class="n">ovi</span><span class="p">)</span>
            <span class="n">err</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span>
                <span class="n">lc_unit_observed</span><span class="p">[</span><span class="n">valid_inds</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">box_lc</span> <span class="o">+</span> <span class="n">wing_lc</span><span class="p">)[</span><span class="n">valid_inds</span><span class="p">]</span>
            <span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">err</span>

        <span class="n">opt_sol</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;maxiter&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">})</span>
        <span class="k">return</span> <span class="n">construct_from_y</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">attitude</span><span class="p">,</span> <span class="n">opt_sol</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>


<span class="n">date_start</span> <span class="o">=</span> <span class="n">mr</span><span class="o">.</span><span class="n">utc</span><span class="p">(</span><span class="mi">2023</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="p">(</span><span class="n">dates</span><span class="p">,</span> <span class="n">epsecs</span><span class="p">)</span> <span class="o">=</span> <span class="n">mr</span><span class="o">.</span><span class="n">date_linspace</span><span class="p">(</span>
    <span class="n">date_start</span> <span class="o">-</span> <span class="n">mr</span><span class="o">.</span><span class="n">days</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">date_start</span><span class="p">,</span> <span class="mf">1e3</span><span class="p">,</span> <span class="n">return_epsecs</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>

<span class="n">station</span> <span class="o">=</span> <span class="n">mr</span><span class="o">.</span><span class="n">Station</span><span class="p">()</span>

<span class="n">station</span><span class="o">.</span><span class="n">constraints</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">mr</span><span class="o">.</span><span class="n">SnrConstraint</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span>
    <span class="n">mr</span><span class="o">.</span><span class="n">ElevationConstraint</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
    <span class="n">mr</span><span class="o">.</span><span class="n">TargetIlluminatedConstraint</span><span class="p">(),</span>
    <span class="n">mr</span><span class="o">.</span><span class="n">ObserverEclipseConstraint</span><span class="p">(</span><span class="n">station</span><span class="p">),</span>
    <span class="n">mr</span><span class="o">.</span><span class="n">VisualMagnitudeConstraint</span><span class="p">(</span><span class="mi">20</span><span class="p">),</span>
    <span class="n">mr</span><span class="o">.</span><span class="n">MoonExclusionConstraint</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>
    <span class="n">mr</span><span class="o">.</span><span class="n">HorizonMaskConstraint</span><span class="p">(</span><span class="n">station</span><span class="p">),</span>
<span class="p">]</span>

<span class="n">obj</span> <span class="o">=</span> <span class="n">mr</span><span class="o">.</span><span class="n">SpaceObject</span><span class="p">(</span><span class="s2">&quot;matlib_hylas4.obj&quot;</span><span class="p">,</span> <span class="n">identifier</span><span class="o">=</span><span class="s2">&quot;superbird 6&quot;</span><span class="p">)</span>
<span class="c1"># obj = mr.SpaceObject(&quot;matlib_tess.obj&quot;, identifier=&quot;NAVSTAR 62 (USA 201)&quot;)</span>
<span class="n">r_obj_j2k</span> <span class="o">=</span> <span class="n">obj</span><span class="o">.</span><span class="n">propagate</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span>

<span class="n">sv</span> <span class="o">=</span> <span class="n">mr</span><span class="o">.</span><span class="n">sun</span><span class="p">(</span><span class="n">dates</span><span class="p">)</span>
<span class="n">nadir</span> <span class="o">=</span> <span class="o">-</span><span class="n">mr</span><span class="o">.</span><span class="n">hat</span><span class="p">(</span><span class="n">r_obj_j2k</span><span class="p">)</span>
<span class="n">attitude</span> <span class="o">=</span> <span class="n">mr</span><span class="o">.</span><span class="n">AlignedAndConstrainedAttitude</span><span class="p">(</span>
    <span class="n">v_align</span><span class="o">=</span><span class="n">nadir</span><span class="p">,</span>
    <span class="n">v_const</span><span class="o">=</span><span class="n">sv</span><span class="p">,</span>
    <span class="n">dates</span><span class="o">=</span><span class="n">dates</span><span class="p">,</span>
    <span class="n">axis_order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">brdf</span> <span class="o">=</span> <span class="n">mr</span><span class="o">.</span><span class="n">Brdf</span><span class="p">(</span><span class="s2">&quot;phong&quot;</span><span class="p">)</span>

<span class="p">(</span><span class="n">lc_ccd_signal</span><span class="p">,</span> <span class="n">aux_data</span><span class="p">)</span> <span class="o">=</span> <span class="n">station</span><span class="o">.</span><span class="n">observe_light_curve</span><span class="p">(</span>
    <span class="n">obj</span><span class="p">,</span>
    <span class="n">attitude</span><span class="p">,</span>
    <span class="n">brdf</span><span class="p">,</span>
    <span class="n">dates</span><span class="p">,</span>
    <span class="n">model_scale_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">use_engine</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">show_window</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">frame_rate</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">instances</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">rotate_panels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">brdf_bwp</span> <span class="o">=</span> <span class="n">mr</span><span class="o">.</span><span class="n">Brdf</span><span class="p">(</span><span class="s2">&quot;phong&quot;</span><span class="p">,</span> <span class="n">cd</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">cs</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">bwp</span> <span class="o">=</span> <span class="n">BoxWingParametric</span><span class="p">(</span><span class="n">attitude</span><span class="p">,</span> <span class="n">brdf_bwp</span><span class="p">,</span> <span class="n">brdf_bwp</span><span class="p">)</span>

<span class="n">lc_noisy_adu</span> <span class="o">=</span> <span class="n">lc_ccd_signal</span><span class="p">()</span>

<span class="n">lc_noisy_irrad</span> <span class="o">=</span> <span class="n">lc_noisy_adu</span> <span class="o">/</span> <span class="n">aux_data</span><span class="p">[</span><span class="s2">&quot;sint&quot;</span><span class="p">]</span>
<span class="n">lc_noisy_unit_irrad</span> <span class="o">=</span> <span class="n">lc_noisy_irrad</span> <span class="o">*</span> <span class="p">(</span><span class="n">aux_data</span><span class="p">[</span><span class="s2">&quot;rmag_station_to_sat&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1e3</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
<span class="n">invalid_inds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">lc_noisy_unit_irrad</span><span class="p">)</span>

<span class="n">ovi</span> <span class="o">=</span> <span class="n">mr</span><span class="o">.</span><span class="n">hat</span><span class="p">(</span><span class="n">aux_data</span><span class="p">[</span><span class="s2">&quot;station_pos_eci&quot;</span><span class="p">]</span> <span class="o">-</span> <span class="n">aux_data</span><span class="p">[</span><span class="s2">&quot;object_pos_eci&quot;</span><span class="p">])</span>
<span class="n">ovb</span> <span class="o">=</span> <span class="n">mr</span><span class="o">.</span><span class="n">stack_mat_mult_vec</span><span class="p">(</span><span class="n">attitude</span><span class="o">.</span><span class="n">dcms_at_dates</span><span class="p">(</span><span class="n">dates</span><span class="p">),</span> <span class="n">ovi</span><span class="p">)</span>

<span class="n">bwp_opt</span> <span class="o">=</span> <span class="n">bwp</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span> <span class="n">ovi</span><span class="p">,</span> <span class="n">lc_noisy_unit_irrad</span><span class="p">)</span>
<span class="n">box_lc_opt</span><span class="p">,</span> <span class="n">wing_lc_opt</span> <span class="o">=</span> <span class="n">bwp_opt</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span> <span class="n">ovi</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">bwp_opt</span><span class="o">.</span><span class="n">wing_area</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">bwp_opt</span><span class="o">.</span><span class="n">scales</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">bwp_opt</span><span class="o">.</span><span class="n">brdf_box</span><span class="o">.</span><span class="n">cd</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">bwp_opt</span><span class="o">.</span><span class="n">brdf_wing</span><span class="o">.</span><span class="n">cd</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">bwp_opt</span><span class="o">.</span><span class="n">brdf_box</span><span class="o">.</span><span class="n">n</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">bwp_opt</span><span class="o">.</span><span class="n">brdf_wing</span><span class="o">.</span><span class="n">n</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">bwp_opt</span><span class="o">.</span><span class="n">brdf_box</span><span class="o">.</span><span class="n">cs</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">,</span>
    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">bwp_opt</span><span class="o">.</span><span class="n">brdf_wing</span><span class="o">.</span><span class="n">cs</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span> <span class="n">lc_noisy_unit_irrad</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span> <span class="n">aux_data</span><span class="p">[</span><span class="s2">&quot;lc_clean_norm&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">dates</span><span class="p">,</span> <span class="n">wing_lc_opt</span> <span class="o">+</span> <span class="n">box_lc_opt</span><span class="p">)</span>
<span class="c1"># plt.plot(dates, box_lc_opt)</span>
<span class="c1"># plt.plot(dates, wing_lc_opt)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">&quot;noisy_true&quot;</span><span class="p">,</span> <span class="s2">&quot;clean_true&quot;</span><span class="p">,</span> <span class="s2">&quot;recon&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  12.245 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-gallery-01-light-curve-inversion-parametric-box-wing-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/1b6ff90fbf475d009463c99eedcfc4a8/parametric_box_wing.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">parametric_box_wing.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/8adfa188e521352228240e281f4e0429/parametric_box_wing.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">parametric_box_wing.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="face_uncertainty.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Face Uncertainty</p>
      </div>
    </a>
    <a class="right-next"
       href="multi_hypothesis_inversion.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Multiple Hypothesis Inversion</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
       Copyright 2024-2024, Liam Robinson.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.0.1.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>