
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gallery/04-environment/star_catalogs.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_gallery_04-environment_star_catalogs.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_04-environment_star_catalogs.py:


Star Catalogs
=============

Initializing and querying star catalogs

.. GENERATED FROM PYTHON SOURCE LINES 7-40

.. code-block:: Python


    import matplotlib.pyplot as plt
    import numpy as np

    import mirage as mr
    import mirage.vis as mrv

    station = mr.Station()
    date = mr.now()
    mr.tic('Loading Gaia')
    gaia = mr.GaiaStarCatalog(station, date)
    mr.toc()

    mr.tic('Loading Tycho-2')
    tycho2 = mr.Tycho2StarCatalog(station, date)
    mr.toc()

    eci_look_dir = mr.hat(np.array([1, 1, 0]))
    look_ra, look_dec = mr.eci_to_ra_dec(eci_look_dir)
    scope_up_initial = np.array([0, 1, 0])
    telescope = mr.Telescope(preset='pogs')
    mr.tic('Finding stars in frame for Tycho-2')
    if_uvs_tycho2, if_spec_tycho2 = tycho2.in_fov(eci_look_dir, scope_up_initial)
    mr.toc()

    print(f'Tycho-2 found {if_uvs_tycho2.shape[0]} stars in frame')

    mr.tic('Finding stars in frame for Gaia')
    if_uvs_gaia, if_spec_gaia = gaia.in_fov(eci_look_dir, scope_up_initial)
    mr.toc()

    print(f'Gaia found {if_uvs_gaia.shape[0]} stars in frame')





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Loading Gaia: 1.35e+00 seconds
    Loading Tycho-2: 2.93e-01 seconds
    Finding stars in frame for Tycho-2: 2.48e-03 seconds
    Tycho-2 found 17 stars in frame
    Finding stars in frame for Gaia: 3.97e-04 seconds
    Gaia found 79 stars in frame




.. GENERATED FROM PYTHON SOURCE LINES 41-42

Plotting the FOV stars

.. GENERATED FROM PYTHON SOURCE LINES 42-59

.. code-block:: Python

    gaia_pix_x, gaia_pix_y = telescope.j2000_unit_vectors_to_pixels(
        eci_look_dir, scope_up_initial, if_uvs_gaia
    )
    tycho_pix_x, tycho_pix_y = telescope.j2000_unit_vectors_to_pixels(
        eci_look_dir, scope_up_initial, if_uvs_tycho2
    )

    plt.figure()
    plt.scatter(gaia_pix_x, gaia_pix_y, s=20, c='black')
    plt.scatter(tycho_pix_x, tycho_pix_y, s=1, c='cyan')
    plt.title('Tycho-2 vs Gaia up close')
    plt.xlabel('RA (pixels)')
    plt.ylabel('Dec (pixels)')
    plt.gca().set_aspect('equal')
    plt.legend(['Gaia', 'Tycho-2'])
    plt.show()




.. image-sg:: /gallery/04-environment/images/sphx_glr_star_catalogs_001.png
   :alt: Tycho-2 vs Gaia up close
   :srcset: /gallery/04-environment/images/sphx_glr_star_catalogs_001.png, /gallery/04-environment/images/sphx_glr_star_catalogs_001_2_00x.png 2.00x
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 60-61

Star Aberration

.. GENERATED FROM PYTHON SOURCE LINES 61-70

.. code-block:: Python


    t2 = mr.load_json_data('tycho2.json')
    alpha_rad, delta_rad = t2['j2000_ra'], t2['j2000_dec']
    mr.tic()
    alpha_rad_app, delta_rad_app = mr.apparent_star_positons(
        mr.now(), station.lat_geod_rad, alpha_rad, delta_rad
    )
    mr.toc()





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Elapsed time: 2.04e-01 seconds




.. GENERATED FROM PYTHON SOURCE LINES 71-72

Plotting the resulting right ascensions and declinations

.. GENERATED FROM PYTHON SOURCE LINES 72-84

.. code-block:: Python


    plt.scatter(np.rad2deg(alpha_rad), np.rad2deg(delta_rad), s=2)
    plt.scatter(np.rad2deg(alpha_rad_app), np.rad2deg(delta_rad_app), s=2)
    plt.xlim(0, 1)
    plt.ylim(0, 1)
    mrv.texit(
        'Apparent and True Star Positions',
        'Right ascension [deg]',
        'Declination [deg]',
        ['True', 'Apparent'],
    )
    plt.show()



.. image-sg:: /gallery/04-environment/images/sphx_glr_star_catalogs_002.png
   :alt: Apparent and True Star Positions
   :srcset: /gallery/04-environment/images/sphx_glr_star_catalogs_002.png, /gallery/04-environment/images/sphx_glr_star_catalogs_002_2_00x.png 2.00x
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 7.911 seconds)


.. _sphx_glr_download_gallery_04-environment_star_catalogs.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: star_catalogs.ipynb <star_catalogs.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: star_catalogs.py <star_catalogs.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: star_catalogs.zip <star_catalogs.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
