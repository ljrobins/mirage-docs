
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gallery/04-environment/shadow_functions.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_gallery_04-environment_shadow_functions.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_04-environment_shadow_functions.py:


Shadow Functions
================

Comparing the effect of the atmosphere on penumbra shadow modeling

.. GENERATED FROM PYTHON SOURCE LINES 7-36

.. code-block:: Python


    import datetime

    import matplotlib.pyplot as plt
    import shado

    import mirage as mr
    import mirage.vis as mrv


    def plot_shadow_function_for_dates(obj, dates) -> None:
        plt.figure(figsize=(8, 4))
        r = obj.propagate(dates)
        s = mr.sun(dates)
        sf = shado.shadow_function(r, s)
        sf_mine = mr.sun_irradiance_fraction(dates, r)

        plt.plot(dates, sf, label='Liu et al. 2019')
        plt.plot(dates, sf_mine, label='Krag 2003')
        mrv.texit(
            f'{obj.sat.name}',
            f"Date UTC ({dates[0].strftime('%b %d %Y')})",
            'Irradiance fraction',
        )
        plt.legend()
        plt.tight_layout()
        plt.show()









.. GENERATED FROM PYTHON SOURCE LINES 37-38

Galileo (MEO)

.. GENERATED FROM PYTHON SOURCE LINES 38-44

.. code-block:: Python


    galileo = mr.SpaceObject('cube.obj', identifier='2011-060A')
    d0 = mr.utc(2015, 1, 11, 18, 33, 34)
    galileo_dates = mr.date_linspace(d0 - mr.minutes(1), d0 + mr.minutes(1), 100)
    plot_shadow_function_for_dates(galileo, galileo_dates)




.. image-sg:: /gallery/04-environment/images/sphx_glr_shadow_functions_001.png
   :alt: GALILEO-PFM
   :srcset: /gallery/04-environment/images/sphx_glr_shadow_functions_001.png, /gallery/04-environment/images/sphx_glr_shadow_functions_001_2_00x.png 2.00x
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 45-46

GRACE (LEO)

.. GENERATED FROM PYTHON SOURCE LINES 46-52

.. code-block:: Python


    grace = mr.SpaceObject('cube.obj', identifier='GRACE 1')
    d0 = mr.utc(2007, 1, 20, 1, 27, 25)
    grace_dates = mr.date_linspace(d0 - mr.seconds(20), d0 + mr.seconds(20), 100)
    plot_shadow_function_for_dates(grace, grace_dates)




.. image-sg:: /gallery/04-environment/images/sphx_glr_shadow_functions_002.png
   :alt: GRACE 1
   :srcset: /gallery/04-environment/images/sphx_glr_shadow_functions_002.png, /gallery/04-environment/images/sphx_glr_shadow_functions_002_2_00x.png 2.00x
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 53-54

SL-3 R/B (LEO)

.. GENERATED FROM PYTHON SOURCE LINES 54-62

.. code-block:: Python


    sl3rb = mr.SpaceObject('cube.obj', identifier='1973-015B')
    d0, df = (
        datetime.datetime.fromisoformat('2021-05-03 22:35:06.904337+02:00'),
        datetime.datetime.fromisoformat('2021-05-03 22:36:38.541901+02:00'),
    )
    sl3rb_dates = mr.date_linspace(d0, df, 100)
    plot_shadow_function_for_dates(sl3rb, sl3rb_dates)



.. image-sg:: /gallery/04-environment/images/sphx_glr_shadow_functions_003.png
   :alt: SL-3 R/B
   :srcset: /gallery/04-environment/images/sphx_glr_shadow_functions_003.png, /gallery/04-environment/images/sphx_glr_shadow_functions_003_2_00x.png 2.00x
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 4.375 seconds)


.. _sphx_glr_download_gallery_04-environment_shadow_functions.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: shadow_functions.ipynb <shadow_functions.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: shadow_functions.py <shadow_functions.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: shadow_functions.zip <shadow_functions.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
