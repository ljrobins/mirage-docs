
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gallery/04-environment/background_signals.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_gallery_04-environment_background_signals.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_04-environment_background_signals.py:


Background Signals
==================

The mean background signal model due to various sources

.. GENERATED FROM PYTHON SOURCE LINES 7-16

.. code-block:: Python


    import datetime

    import numpy as np
    import pyvista as pv

    import mirage as mr
    import mirage.vis as mrv








.. GENERATED FROM PYTHON SOURCE LINES 17-18

Defining a function we can use to plot various background signals

.. GENERATED FROM PYTHON SOURCE LINES 18-107

.. code-block:: Python



    def hemisphere_signal(
        station: mr.Station,
        date: datetime.datetime,
        signal_kwargs: dict,
    ) -> None:
        true_signals = [k for k in signal_kwargs.keys() if signal_kwargs[k]]
        if len(true_signals) == len(signal_kwargs.keys()):
            signal_type = 'All Signals'
        else:
            signal_type = true_signals[0].capitalize()

        pl = pv.Plotter()
        c_grid = mrv.celestial_grid(30, 30)
        c_grid = (station.eci_to_enu(date).T @ c_grid.T).T
        (g_az, g_el) = np.meshgrid(
            np.linspace(0, 2 * np.pi, 250, endpoint=False),
            np.linspace(np.deg2rad(0), np.pi / 2, 250, endpoint=False),
        )

        look_dirs_eci_eq = station.az_el_to_eci(g_az.flatten(), g_el.flatten(), date)
        dates = np.tile(date, (g_az.size, 1))
        stat_eci = station.j2000_at_dates(date)

        mr.tic()
        sb = station.sky_brightness(
            dates, look_dirs_eci_eq, **signal_kwargs, integration_time_s=1.0
        )
        mr.toc()
        mrv.plot_earth(
            pl,
            date=date,
            atmosphere=False,
            lighting=True,
            night_lights=True,
            borders=True,
        )
        r_dome = 500  # km
        view_dist = 20e3  # km
        zoom = 4.5
        sargs = dict(
            height=0.75,
            vertical=True,
            position_x=0.05,
            position_y=0.05,
            title_font_size=24,
            label_font_size=20,
            shadow=True,
            n_labels=4,
            fmt='%.3e',
            font_family='courier',
            color='white',
        )

        mrv.plot3(
            pl,
            stat_eci + 1.03 * r_dome * c_grid,
            line_width=4,
            color='linen',
            lighting=False,
        )

        mrv.scatter3(
            pl,
            stat_eci + r_dome * look_dirs_eci_eq,
            scalars=sb.flatten(),
            cmap='bmy',
            point_size=10,
            lighting=False,
            clim=[0, np.max(sb)],
            scalar_bar_args=sargs,
        )
        pl.scalar_bar.SetTitle('[e-/pix]')
        pl.camera.focal_point = stat_eci.flatten()
        cpos = (stat_eci + mr.hat(stat_eci) * view_dist).flatten() - np.array([0, 0, 1e4])
        pl.camera.position = cpos
        pl.camera.zoom(zoom)

        pl.add_text(
            f'{signal_type}: {date.strftime("%m/%d/%Y, %H:%M:%S")} UTC',
            name='utc_str',
            font='courier',
            color='white',
        )

        pl.show()









.. GENERATED FROM PYTHON SOURCE LINES 108-110

Setting up observation conditions using an example Space Debris Telescope preset from Krag2003
station = mr.Station(preset="lmt", lat_deg=33.776864, lon_deg=-84.363777) # Atlanta, GA

.. GENERATED FROM PYTHON SOURCE LINES 110-113

.. code-block:: Python

    station = mr.Station(preset='pogs')
    date = mr.utc(2023, 10, 1, 5, 45, 0)  # Fig 5.38








.. GENERATED FROM PYTHON SOURCE LINES 114-115

Plotting the background signal for scattered moonlight

.. GENERATED FROM PYTHON SOURCE LINES 115-125

.. code-block:: Python

    signal_kwargs = {
        'moonlight': True,
        'airglow': False,
        'integrated_starlight': False,
        'zodiac': False,
        'pollution': False,
        'twilight': False,
    }
    hemisphere_signal(station, date, signal_kwargs)




.. image-sg:: /gallery/04-environment/images/sphx_glr_background_signals_001.png
   :alt: background signals
   :srcset: /gallery/04-environment/images/sphx_glr_background_signals_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Elapsed time: 4.12e+00 seconds




.. GENERATED FROM PYTHON SOURCE LINES 126-127

Plotting the background signal for integrated starlight

.. GENERATED FROM PYTHON SOURCE LINES 127-137

.. code-block:: Python

    signal_kwargs = {
        'moonlight': False,
        'airglow': False,
        'integrated_starlight': True,
        'zodiac': False,
        'pollution': False,
        'twilight': False,
    }
    hemisphere_signal(station, date, signal_kwargs)




.. image-sg:: /gallery/04-environment/images/sphx_glr_background_signals_002.png
   :alt: background signals
   :srcset: /gallery/04-environment/images/sphx_glr_background_signals_002.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Elapsed time: 2.07e+00 seconds




.. GENERATED FROM PYTHON SOURCE LINES 138-139

Plotting the background signal for light pollution

.. GENERATED FROM PYTHON SOURCE LINES 139-149

.. code-block:: Python

    signal_kwargs = {
        'moonlight': False,
        'airglow': False,
        'integrated_starlight': False,
        'zodiac': False,
        'pollution': True,
        'twilight': False,
    }
    hemisphere_signal(station, date, signal_kwargs)




.. image-sg:: /gallery/04-environment/images/sphx_glr_background_signals_003.png
   :alt: background signals
   :srcset: /gallery/04-environment/images/sphx_glr_background_signals_003.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Elapsed time: 2.13e+00 seconds




.. GENERATED FROM PYTHON SOURCE LINES 150-151

Plotting the background signal for zodiac light

.. GENERATED FROM PYTHON SOURCE LINES 151-161

.. code-block:: Python

    signal_kwargs = {
        'moonlight': False,
        'airglow': False,
        'integrated_starlight': False,
        'zodiac': True,
        'pollution': False,
        'twilight': False,
    }
    hemisphere_signal(station, date, signal_kwargs)




.. image-sg:: /gallery/04-environment/images/sphx_glr_background_signals_004.png
   :alt: background signals
   :srcset: /gallery/04-environment/images/sphx_glr_background_signals_004.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Elapsed time: 3.01e+00 seconds




.. GENERATED FROM PYTHON SOURCE LINES 162-163

Plotting the background signal for airglow

.. GENERATED FROM PYTHON SOURCE LINES 163-173

.. code-block:: Python

    signal_kwargs = {
        'moonlight': False,
        'airglow': True,
        'integrated_starlight': False,
        'zodiac': False,
        'pollution': False,
        'twilight': False,
    }
    hemisphere_signal(station, date, signal_kwargs)




.. image-sg:: /gallery/04-environment/images/sphx_glr_background_signals_005.png
   :alt: background signals
   :srcset: /gallery/04-environment/images/sphx_glr_background_signals_005.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Elapsed time: 2.12e+00 seconds




.. GENERATED FROM PYTHON SOURCE LINES 174-175

Plotting the background signal for scattered twilight

.. GENERATED FROM PYTHON SOURCE LINES 175-185

.. code-block:: Python

    signal_kwargs = {
        'moonlight': False,
        'airglow': False,
        'integrated_starlight': False,
        'zodiac': False,
        'pollution': False,
        'twilight': True,
    }
    hemisphere_signal(station, date - mr.hours(4), signal_kwargs)




.. image-sg:: /gallery/04-environment/images/sphx_glr_background_signals_006.png
   :alt: background signals
   :srcset: /gallery/04-environment/images/sphx_glr_background_signals_006.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Elapsed time: 6.84e+00 seconds




.. GENERATED FROM PYTHON SOURCE LINES 186-187

Plotting the full background signal with all sources enabled

.. GENERATED FROM PYTHON SOURCE LINES 187-196

.. code-block:: Python

    signal_kwargs = {
        'moonlight': True,
        'airglow': True,
        'integrated_starlight': True,
        'zodiac': True,
        'pollution': True,
        'twilight': True,
    }
    hemisphere_signal(station, date, signal_kwargs)



.. image-sg:: /gallery/04-environment/images/sphx_glr_background_signals_007.png
   :alt: background signals
   :srcset: /gallery/04-environment/images/sphx_glr_background_signals_007.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Elapsed time: 1.09e+01 seconds





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 40.089 seconds)


.. _sphx_glr_download_gallery_04-environment_background_signals.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: background_signals.ipynb <background_signals.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: background_signals.py <background_signals.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: background_signals.zip <background_signals.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
