
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gallery/04-environment/penumbra_plane.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_gallery_04-environment_penumbra_plane.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_04-environment_penumbra_plane.py:


Penumbra Visualized
===================

Visualizing the penumbra and umbra of the Earth's shadow.

.. GENERATED FROM PYTHON SOURCE LINES 7-53



.. image-sg:: /gallery/04-environment/images/sphx_glr_penumbra_plane_001.png
   :alt: penumbra plane
   :srcset: /gallery/04-environment/images/sphx_glr_penumbra_plane_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Elapsed time: 2.95e+00 seconds






|

.. code-block:: Python


    import numpy as np
    import pyvista as pv

    import mirage as mr
    import mirage.vis as mrv

    date = mr.utc(2022, 12, 21)

    glim = 80e3
    dim = 3000
    grid_space = np.linspace(-glim, glim, dim)
    gxx, gzz = np.meshgrid(grid_space, grid_space)

    rotm = mr.eci_to_sun_ec(date)
    gpts = np.vstack((gxx.flatten(), 0 * gxx.flatten(), gzz.flatten())).T
    gpts = gpts @ rotm.squeeze()

    mr.AstroConstants.sun_r_eq *= 10
    mr.tic()
    f_shadow = 1 - mr.sun_irradiance_fraction(date, gpts)
    mr.toc()

    pl = pv.Plotter(window_size=(1600, 800))
    mrv.plot_earth(pl, date=date, atmosphere=True, night_lights=True, lighting=True)
    mrv.scatter3(
        pl,
        gpts,
        scalars=f_shadow,
        point_size=8,
        lighting=False,
        cmap='bmy_r',
        opacity=(f_shadow > 0) * 1,
        scalar_bar_args={'title': 'Shadow Fraction'},
    )
    pl.view_xz()
    pl.camera.up = np.array([0, 0, -1]) @ rotm.squeeze()
    pl.camera.position = np.array([0e3, -40e3, 0]) @ rotm.squeeze()

    # shift = np.array([-30e4, 0, 0]) @ rotm.squeeze()
    # pl.camera.position += shift
    # pl.camera.focal_point += shift
    pl.camera.zoom(1.2)
    pl.set_background('white')
    # pl.disable_parallel_projection()
    pl.show()


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 7.687 seconds)


.. _sphx_glr_download_gallery_04-environment_penumbra_plane.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: penumbra_plane.ipynb <penumbra_plane.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: penumbra_plane.py <penumbra_plane.py>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
