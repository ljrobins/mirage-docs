
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gallery/01-light_curves/engine_vs_convex.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_gallery_01-light_curves_engine_vs_convex.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_01-light_curves_engine_vs_convex.py:


Convex vs Engine Light Curves
=============================

Comparing light curves produced by the LightCurveEngine renderer and a simplified convex method

.. GENERATED FROM PYTHON SOURCE LINES 7-14

.. code-block:: Python


    import matplotlib.pyplot as plt
    import numpy as np
    import seaborn as sns

    import mirage as mr








.. GENERATED FROM PYTHON SOURCE LINES 15-16

Defining the object and BRDF

.. GENERATED FROM PYTHON SOURCE LINES 16-19

.. code-block:: Python

    obj = mr.SpaceObject('cylinder.obj')
    brdf = mr.Brdf('phong', cd=0.1, cs=0.9, n=30)








.. GENERATED FROM PYTHON SOURCE LINES 20-21

Defining the attitude profile

.. GENERATED FROM PYTHON SOURCE LINES 21-34

.. code-block:: Python


    t_eval = np.linspace(0, 10, int(1e3) + 1)
    q, _ = mr.propagate_attitude_torque_free(
        mr.hat(np.array([0.0, 0.0, 0.0, 1.0])),
        np.array([1.0, 1.0, 1.0]),
        np.diag([1, 2, 3]),
        t_eval,
    )

    dcm = mr.quat_to_dcm(q)
    ovb = mr.stack_mat_mult_vec(dcm, np.array([[1, 0, 0]]))
    svb = mr.stack_mat_mult_vec(dcm, np.array([[0, 1, 0]]))








.. GENERATED FROM PYTHON SOURCE LINES 35-36

We can now run the engine and compute a convex light curve:

.. GENERATED FROM PYTHON SOURCE LINES 36-51

.. code-block:: Python


    mr.tic()
    b_non_convex = mr.run_light_curve_engine(
        brdf,
        obj,
        svb,
        ovb,
        instances=25,
        instance_width_pix=540,
    )
    mr.toc()
    b_convex = obj.convex_light_curve(brdf, svb, ovb)

    print(b_non_convex, b_convex)





.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Elapsed time: 7.34e-01 seconds
    [1.436186 1.431122 1.450145 ... 1.427974 1.347964 1.298291] [1.49668747 1.49674882 1.49692643 ... 1.46660954 1.40084044 1.33174767]




.. GENERATED FROM PYTHON SOURCE LINES 52-53

And plot the results

.. GENERATED FROM PYTHON SOURCE LINES 53-65

.. code-block:: Python


    plt.figure()
    sns.lineplot(x=t_eval, y=b_non_convex, errorbar=None)
    sns.lineplot(x=t_eval, y=b_convex, errorbar=None)
    plt.title(f'Light Curves for {obj.file_name}')
    plt.xlabel('Time [s]')
    plt.ylabel('Normalized brightness')
    plt.legend(['LightCurveEngine', 'Convex'])
    plt.grid()
    # plt.show()





.. image-sg:: /gallery/01-light_curves/images/sphx_glr_engine_vs_convex_001.png
   :alt: Light Curves for cylinder.obj
   :srcset: /gallery/01-light_curves/images/sphx_glr_engine_vs_convex_001.png, /gallery/01-light_curves/images/sphx_glr_engine_vs_convex_001_2_00x.png 2.00x
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 66-67

Plotting the error instead of the brightness values

.. GENERATED FROM PYTHON SOURCE LINES 67-76

.. code-block:: Python


    plt.figure()
    sns.lineplot(x=t_eval, y=b_non_convex - b_convex, errorbar=None)
    plt.title(f'Light Curves Error for {obj.file_name}')
    plt.xlabel('Time [s]')
    plt.ylabel('Normalized brightness error')
    plt.grid()
    plt.show()




.. image-sg:: /gallery/01-light_curves/images/sphx_glr_engine_vs_convex_002.png
   :alt: Light Curves Error for cylinder.obj
   :srcset: /gallery/01-light_curves/images/sphx_glr_engine_vs_convex_002.png, /gallery/01-light_curves/images/sphx_glr_engine_vs_convex_002_2_00x.png 2.00x
   :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 77-78

This is nice and small, which we like to see. If we repeat this process for a non-convex object, the error quickly becomes clear

.. GENERATED FROM PYTHON SOURCE LINES 78-99

.. code-block:: Python


    obj = mr.SpaceObject('tess.obj')
    brdf = mr.Brdf('phong', cd=0.5, cs=0.5, n=5)

    b_non_convex = mr.run_light_curve_engine(brdf, obj, svb, ovb, instances=1)
    b_non_convex_rotating = mr.run_light_curve_engine(
        brdf, obj, svb, ovb, instances=1, rotate_panels=True
    )
    b_convex = obj.convex_light_curve(brdf, svb, ovb)


    plt.figure()
    sns.lineplot(x=t_eval, y=b_non_convex, errorbar=None)
    sns.lineplot(x=t_eval, y=b_non_convex_rotating, errorbar=None)
    sns.lineplot(x=t_eval, y=b_convex, errorbar=None)
    plt.title(f'Light Curves for {obj.file_name}')
    plt.xlabel('Time [s]')
    plt.ylabel('Normalized brightness')
    plt.legend(['LightCurveEngine', 'LightCurveEngine - rotating panels', 'Convex'])
    plt.grid()
    plt.show()



.. image-sg:: /gallery/01-light_curves/images/sphx_glr_engine_vs_convex_003.png
   :alt: Light Curves for tess.obj
   :srcset: /gallery/01-light_curves/images/sphx_glr_engine_vs_convex_003.png, /gallery/01-light_curves/images/sphx_glr_engine_vs_convex_003_2_00x.png 2.00x
   :class: sphx-glr-single-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 7.425 seconds)


.. _sphx_glr_download_gallery_01-light_curves_engine_vs_convex.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: engine_vs_convex.ipynb <engine_vs_convex.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: engine_vs_convex.py <engine_vs_convex.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: engine_vs_convex.zip <engine_vs_convex.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
