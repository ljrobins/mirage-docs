
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gallery/03-coordinate-systems/equation_of_time.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_gallery_03-coordinate-systems_equation_of_time.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_03-coordinate-systems_equation_of_time.py:


The Equation of Time
====================

The equation of time is the difference between apparent solar time and mean solar time. It is caused by the eccentricity of the Earth's orbit and the tilt of the Earth's axis. The equation of time is a periodic function with a period of one year.

.. GENERATED FROM PYTHON SOURCE LINES 7-31



.. image-sg:: /gallery/03-coordinate-systems/images/sphx_glr_equation_of_time_001.png
   :alt: The Equation of Time
   :srcset: /gallery/03-coordinate-systems/images/sphx_glr_equation_of_time_001.png, /gallery/03-coordinate-systems/images/sphx_glr_equation_of_time_001_2_00x.png 2.00x
   :class: sphx-glr-single-img





.. code-block:: Python


    import matplotlib.pyplot as plt
    import numpy as np

    import mirage as mr
    import mirage.vis as mrv

    date0 = mr.utc(2023, 1, 1, 12)
    dates, epsecs = mr.date_arange(
        date0, date0 + mr.years(1), mr.days(1), return_epsecs=True
    )
    year_frac = epsecs / epsecs[-1]

    sun_pos = mr.sun(dates)
    sun_pos = mr.stack_mat_mult_vec(mr.j2000_to_itrf(dates), sun_pos)
    sun_lon = np.arctan2(sun_pos[:, 1], sun_pos[:, 0])


    plt.plot(
        12 * year_frac, -sun_lon / (np.pi * 2) * 86400 / 60, label="Apparent solar time"
    )
    mrv.texit("The Equation of Time", "Month of the Year", "Minutes")
    plt.legend()
    plt.show()


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 0.351 seconds)


.. _sphx_glr_download_gallery_03-coordinate-systems_equation_of_time.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: equation_of_time.ipynb <equation_of_time.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: equation_of_time.py <equation_of_time.py>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
