
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "gallery/00-orbits/iod.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_gallery_00-orbits_iod.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_gallery_00-orbits_iod.py:


Classical IOD Methods
=====================

.. GENERATED FROM PYTHON SOURCE LINES 6-63



.. image-sg:: /gallery/00-orbits/images/sphx_glr_iod_001.png
   :alt: iod
   :srcset: /gallery/00-orbits/images/sphx_glr_iod_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Gibbs: 1.93e-04 seconds
    Herrick-Gibbs: 4.00e-05 seconds
    Laplace: 5.07e-03 seconds
    Gauss: 3.17e-03 seconds






|

.. code-block:: Python


    import numpy as np
    import pyvista as pv

    import mirage as mr
    import mirage.vis as mrv

    station = mr.Station()
    obj = mr.SpaceObject("cube.obj", identifier=36411)
    dates = mr.date_linspace(mr.now(), mr.now() + mr.seconds(200), 3)
    o_pos = obj.propagate(dates)
    s_pos = station.j2000_at_dates(dates)

    look_dirs_eci = mr.hat(
        o_pos
        - s_pos
        + np.random.multivariate_normal(
            mean=[0.0, 0.0, 0.0], cov=1e-5 * np.eye(3), size=o_pos.shape
        )
    )

    ras, decs = mr.eci_to_ra_dec(look_dirs_eci)

    # Position vector methods
    mr.tic("Gibbs")
    state2_gibbs = mr.gibbs_iod(o_pos)
    mr.toc()
    mr.tic("Herrick-Gibbs")
    state2_herrick_gibbs = mr.herrick_gibbs_iod(o_pos, dates)
    mr.toc()
    # Angles-only methods
    mr.tic("Laplace")
    state2_laplace = mr.laplace_iod(station, dates, ras, decs)
    mr.toc()
    mr.tic("Gauss")
    state2_gauss = mr.gauss_iod(station, dates, ras, decs)
    mr.toc()

    dense_dates = mr.date_linspace(mr.now(), mr.now() + mr.days(1), 1_000)
    obj_pos = obj.propagate(dense_dates)

    pl = pv.Plotter()
    mrv.plot3(pl, obj_pos, line_width=10, lighting=False, color="r")

    iod_pos_gauss = mr.integrate_orbit_dynamics(state2_gauss, dense_dates)[:, :3]
    mrv.plot3(pl, iod_pos_gauss, line_width=10, lighting=False, color="lime")

    iod_pos_gibbs = mr.integrate_orbit_dynamics(state2_gibbs, dense_dates)[:, :3]
    mrv.plot3(pl, iod_pos_gibbs, line_width=10, lighting=False, color="white")

    iod_pos_herrick_gibbs = mr.integrate_orbit_dynamics(state2_herrick_gibbs, dense_dates)[
        :, :3
    ]
    mrv.plot3(pl, iod_pos_herrick_gibbs, line_width=10, lighting=False, color="b")

    mrv.plot_earth(pl)
    pl.show()


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 3.915 seconds)


.. _sphx_glr_download_gallery_00-orbits_iod.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: iod.ipynb <iod.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: iod.py <iod.py>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
